import{c as v}from"./cartStore-L6KSN49T.js";import{I as $,J as C,K as _,m as I,_ as m,o as n,c as r,L as b,M as A,a as t,F as P,r as f,t as d,b as g,d as h,O as E}from"./index-PlfObuNy.js";import{s as T}from"./sweetalert2.all-uxBgj25U.js";import{p as k}from"./paginationComponent-O7SD22Av.js";var S={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"annchou",BASE_URL:"/vue_week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:V,VITE_PATH:w}=S,p=$("allProductsStore",{state:()=>({allProducts:[],categoryList:[]}),actions:{getAllProducts(){const o=`${V}/api/${w}/products/all`;C.get(o).then(e=>{this.allProducts=e.data.products,this.getCategoryList()}).catch(e=>{T.fire({icon:"error",text:e.response.data.message})})},getCategoryList(){const o=new Set(this.allProducts.map(e=>e.category));this.categoryList=[...o]}}}),x={data(){return{currentCategory:""}},watch:{currentCategory(){this.$emit("getProductList",1,this.currentCategory)}},methods:{..._(p,["getAllProducts"])},computed:{...I(p,["allProducts","categoryList"])}},D=t("label",{for:"category",class:"me-3"},"產品分類篩選",-1),R=t("option",{value:""},"全部",-1),B=["value"];function H(o,e,u,l,a,c){return n(),r("div",null,[D,b(t("select",{name:"category",id:"category","onUpdate:modelValue":e[0]||(e[0]=i=>a.currentCategory=i)},[R,(n(!0),r(P,null,f(o.categoryList,i=>(n(),r("option",{value:i,key:i},d(i),9,B))),128))],512),[[A,a.currentCategory]])])}const O=m(x,[["render",H]]);var U={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"annchou",BASE_URL:"/vue_week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:G,VITE_PATH:M}=U,z={data(){return{productsList:[],pagination:{}}},methods:{..._(v,["addToCart"]),..._(p,["getAllProducts"]),getProductList(o=1,e){console.log("productList 的 getProductList");let u=`${G}/api/${M}/products?page=${o}`;e&&(u+=`&category=${e}`),this.axios.get(u).then(l=>{const{products:a,pagination:c}=l.data;this.productsList=a,this.pagination=c}).catch(l=>{this.$swal.fire({icon:"error",text:l.response.data.message})})},showProductInfo(o){console.log("productList 的 showProductInfo"),this.$router.push(`/productinfo/${o}`)}},mounted(){console.log("productList 的 mounted"),this.getProductList(),this.getAllProducts()},components:{paginationComponent:k,filterCategory:O}},F={class:"container"},N=t("h2",{class:"py-5 h2 text-center"},"看產品",-1),J={class:"table align-middle"},K=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1),j={style:{width:"200px"}},q={key:0,class:"h5"},Q={key:1},W={class:"h6"},X={class:"h5"},Y={class:"btn-group btn-group-sm"},Z=["onClick"],tt=["onClick"];function et(o,e,u,l,a,c){const i=g("filterCategory"),y=g("paginationComponent");return n(),r("div",F,[N,h(i,{onGetProductList:c.getProductList},null,8,["onGetProductList"]),t("table",J,[K,t("tbody",null,[(n(!0),r(P,null,f(a.productsList,s=>(n(),r("tr",{key:s.id},[t("td",j,[t("div",{style:E([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${s.imageUrl})`}])},null,4)]),t("td",null,d(s.title),1),t("td",null,[s.price?(n(),r("div",Q,[t("del",W,"原價 "+d(s.origin_price)+" 元",1),t("div",X,"現在只要 "+d(s.price)+" 元",1)])):(n(),r("div",q,d(s.origin_price)+" 元",1))]),t("td",null,[t("div",Y,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:L=>c.showProductInfo(s.id)}," 查看更多 ",8,Z),t("button",{type:"button",class:"btn btn-outline-danger",onClick:L=>o.addToCart(s.id,1)}," 加到購物車 ",8,tt)])])]))),128))])]),h(y,{pagination:a.pagination,onGetProductList:c.getProductList},null,8,["pagination","onGetProductList"])])}const at=m(z,[["render",et]]);export{at as default};
