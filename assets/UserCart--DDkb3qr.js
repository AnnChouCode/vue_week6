import{c as v}from"./cartStore-WMF80jHU.js";import{_ as k,b as w,m as q,d as p,o as i,c as d,a as e,F as g,r as T,t as u,h as b,e as n,w as y,g as V,M as B,R as E,n as _}from"./index-OjM1QzHf.js";import"./sweetalert2.all-Vzh4P7VD.js";var U={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"annchou",BASE_URL:"/vue_week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:x,VITE_PATH:C}=U,A={data(){return{form:{user:{email:"",tel:"",address:""},message:""}}},methods:{...w(v,["getCartsList","updateCart","deleteCartItem"]),submitOrder(){if(!this.cartsList.carts.length){this.$swal.fire("購物車內沒有商品");return}const l=this.$loading.show(),t=`${x}/api/${C}/order`,h={data:this.form};this.axios.post(t,h).then(r=>{this.$swal.fire(r.data.message),this.$refs.form.resetForm(),this.getCartsList()}).catch(r=>{this.$swal.fire({icon:"error",text:r.response.data.message})}).finally(()=>{l.hide()})},clearCartsList(){this.$swal.fire({title:"確定要清空購物車嗎？",text:"這個動作無法復原",icon:"question",showCancelButton:!0,confirmButtonColor:"#000000",cancelButtonColor:"gray",confirmButtonText:"OK"}).then(l=>{if(l.isConfirmed){const t=this.$loading.show(),h=`${x}/api/${C}/carts`;this.axios.delete(h).then(r=>{this.$swal.fire(r.data.message),this.getCartsList()}).catch(r=>this.$swal.fire({icon:"error",text:r.response.data.message})).finally(()=>{t.hide()})}})}},mounted(){this.getCartsList()},computed:{...q(v,["cartsList"])}},I={class:"container py-5"},S=e("h2",{class:"mb-5 text-center"},"購物車",-1),D={class:"text-end"},M=["disabled"],O={key:0,class:"text-center"},P={key:1,class:"table align-middle"},N=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",{style:{width:"150px"}},"數量/單位"),e("th",null,"單價")])],-1),R=["onClick"],$={key:0,class:"text-success"},F={class:"input-group input-group-sm"},H={class:"input-group mb-3"},j=["onUpdate:modelValue","onBlur"],z={class:"input-group-text",id:"basic-addon2"},K={class:"text-end"},G={key:0,class:"text-success"},J=e("td",{colspan:"3",class:"text-end"},"總計",-1),Q={class:"text-end"},W={key:0},X=e("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),Y={class:"text-end text-success"},Z={class:"py-4 bg-light"},ee={class:"container"},se={class:"my-5 row justify-content-center"},te=e("h2",{class:"text-center"},"訂購資料",-1),oe={class:"mb-3"},le=e("label",{for:"email",class:"form-label has-required"},"Email",-1),ae={class:"mb-3"},ne=e("label",{for:"name",class:"form-label has-required"},"收件人姓名",-1),re={class:"mb-3"},ie=e("label",{for:"tel",class:"form-label has-required"},"收件人電話",-1),de={class:"mb-3"},ce=e("label",{for:"address",class:"form-label has-required"},"收件人地址",-1),me={class:"mb-3"},ue=e("label",{for:"payment",class:"form-label has-required"},"請選擇付款方式",-1),_e=e("option",{value:""},"請選擇付款方式",-1),he=e("option",{value:"credit_card"},"信用卡付款",-1),fe=e("option",{value:"ATM"},"ATM 付款",-1),pe={class:"mb-3"},be=e("label",{for:"message",class:"form-label"},"留言",-1),ve=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-danger"},"送出訂單")],-1);function ge(l,t,h,r,a,f){const c=p("v-field"),m=p("error-message"),L=p("v-form");return i(),d(g,null,[e("div",I,[S,e("div",D,[e("button",{class:"btn btn-outline-danger",type:"button",onClick:t[0]||(t[0]=(...s)=>f.clearCartsList&&f.clearCartsList(...s)),disabled:!l.cartsList.final_total},"清空購物車",8,M)]),l.cartsList.final_total?(i(),d("table",P,[N,e("tbody",null,[(i(!0),d(g,null,T(l.cartsList.carts,s=>(i(),d("tr",{key:s.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:o=>l.deleteCartItem(s.id)}," x ",8,R)]),e("td",null,[V(u(s.product.title)+" ",1),s.coupon?(i(),d("div",$," 已套用優惠券 ")):b("",!0)]),e("td",null,[e("div",F,[e("div",H,[B(e("input",{min:"1",type:"number",class:"form-control","onUpdate:modelValue":o=>s.qty=o,onBlur:o=>l.updateCart(s)},null,40,j),[[E,s.qty,void 0,{number:!0}]]),e("span",z,u(s.product.unit),1)])])]),e("td",K,[s.total!==s.final_total?(i(),d("small",G,"折扣價：")):b("",!0),V(" "+u(s.final_total),1)])]))),128))]),e("tfoot",null,[e("tr",null,[J,e("td",Q,u(l.cartsList.total),1)]),l.cartsList.total!==l.cartsList.final_total?(i(),d("tr",W,[X,e("td",Y,u(l.cartsList.final_total),1)])):b("",!0)])])):(i(),d("p",O,"目前購物車內沒有內容"))]),e("div",Z,[e("div",ee,[e("div",se,[te,n(L,{ref:"form",class:"col-md-6",onSubmit:f.submitOrder},{default:y(({errors:s})=>[e("div",oe,[le,n(c,{id:"email",name:"email",type:"email",class:_(["form-control",{"is-invalid":s.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:a.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=o=>a.form.user.email=o)},null,8,["class","modelValue"]),n(m,{name:"email",class:"invalid-feedback"})]),e("div",ae,[ne,n(c,{id:"name",name:"name",type:"text",class:_(["form-control",{"is-invalid":s.name}]),placeholder:"請輸入姓名",rules:"required",modelValue:a.form.user.name,"onUpdate:modelValue":t[2]||(t[2]=o=>a.form.user.name=o)},null,8,["class","modelValue"]),n(m,{name:"name",class:"invalid-feedback"})]),e("div",re,[ie,n(c,{id:"tel",name:"tel",type:"tel",class:_(["form-control",{"is-invalid":s.tel}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:a.form.user.tel,"onUpdate:modelValue":t[3]||(t[3]=o=>a.form.user.tel=o)},null,8,["class","modelValue"]),n(m,{name:"tel",class:"invalid-feedback"})]),e("div",de,[ce,n(c,{id:"address",name:"address",type:"text",class:_(["form-control",{"is-invalid":s.address}]),placeholder:"請輸入地址",rules:"required",modelValue:a.form.user.address,"onUpdate:modelValue":t[4]||(t[4]=o=>a.form.user.address=o)},null,8,["class","modelValue"]),n(m,{name:"address",class:"invalid-feedback"})]),e("div",me,[ue,n(c,{id:"payment",name:"payment",class:_(["form-control",{"is-invalid":s.payment}]),placeholder:"請選擇付款方式",rules:"required",modelValue:a.form.user.payment,"onUpdate:modelValue":t[5]||(t[5]=o=>a.form.user.payment=o),as:"select"},{default:y(()=>[_e,he,fe]),_:2},1032,["class","modelValue"]),n(m,{name:"payment",class:"invalid-feedback"})]),e("div",pe,[be,n(c,{id:"message",name:"message",class:"form-control",cols:"30",rows:"10",modelValue:a.form.message,"onUpdate:modelValue":t[6]||(t[6]=o=>a.form.message=o),as:"textarea"},null,8,["modelValue"])]),ve]),_:1},8,["onSubmit"])])])])],64)}const Ce=k(A,[["render",ge]]);export{Ce as default};
